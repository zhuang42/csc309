(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{127:function(e,t,a){e.exports=a(301)},301:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),r=a(25),s=a.n(r);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var o=a(9),c=a(3),h=a(10),l=a(4),u=a(2),d=a(8),p=a(34),m=a(61),f=a.n(m),g=a(23),w=a.n(g),v=a(42),y=a.n(v),b=a(22),k=a.n(b),O=a(21),j=a.n(O),E=a(24),x=a.n(E),S=a(33),P=a.n(S),U=a(31),I=a.n(U),_=a(11),C=a.n(_),T=a(29),A=a.n(T),G=a(35),M=a.n(G),L=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(o.a)(this,Object(c.a)(t).call(this,e))).state={userid:"",password:""},a.handleSubmit=a.handleSubmit.bind(Object(l.a)(Object(l.a)(a))),M()("#stage").hide(),a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"handleSubmit",value:function(e){var t=this;e.preventDefault();var a=new FormData(e.target),n={},i=!0,r=!1,s=void 0;try{for(var o,c=a.entries()[Symbol.iterator]();!(i=(o=c.next()).done);i=!0){var h=o.value;console.log(h[0]+", "+h[1])}}catch(l){r=!0,s=l}finally{try{i||null==c.return||c.return()}finally{if(r)throw s}}this.setState(function(e,a){return t.default_state}),n.userid=a.get("userid"),n.password=a.get("password"),A.a.post("/api/user/login",n).then(function(e){t.props.switchToMainGame(),t.props.clientGameSocket.send("login",n.userid),t.props.currentUser.setUserid(n.userid),t.props.currentUser.setPassword(n.password),t.props.getUserInfo(n.userid),t.props.handleInfo("Welcome Back "+n.userid)}).catch(function(e){t.props.handleError(e.response.data.error)})}},{key:"render",value:function(){var e=this.props.classes;return i.a.createElement("main",{className:e.main},i.a.createElement(y.a,null),i.a.createElement(P.a,{className:e.paper},i.a.createElement("div",null,i.a.createElement(w.a,{onClick:this.props.switchToLogin,color:"primary"},"Log In "),i.a.createElement(w.a,{onClick:this.props.switchToSignUp},"Register")),i.a.createElement(f.a,{className:e.avatar},"JO"),i.a.createElement(I.a,{component:"h2",variant:"h5"},"JoJo's Royale Battle"),i.a.createElement("form",{className:e.form,onSubmit:this.handleSubmit},i.a.createElement(k.a,{margin:"normal",required:!0,fullWidth:!0},i.a.createElement(x.a,{htmlFor:"userid"},"User ID"),i.a.createElement(j.a,{id:"userid",name:"userid",autoFocus:!0})),i.a.createElement(k.a,{margin:"normal",required:!0,fullWidth:!0},i.a.createElement(x.a,{htmlFor:"password"},"Password"),i.a.createElement(j.a,{name:"password",type:"password",id:"password"})),i.a.createElement(w.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:e.submit},"Sign In"))))}}]),t}(i.a.Component),R=C()(function(e){return{root:{flexGrow:1},main:Object(p.a)({width:"auto",display:"block",marginLeft:3*e.spacing.unit,marginRight:3*e.spacing.unit},e.breakpoints.up(400+3*e.spacing.unit*2),{width:400,marginLeft:"auto",marginRight:"auto"}),paper:{marginTop:8*e.spacing.unit,display:"flex",flexDirection:"column",alignItems:"center",padding:"".concat(2*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px")},avatar:{margin:e.spacing.unit,backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing.unit},submit:{marginTop:3*e.spacing.unit}}})(L),N=a(41),W=a(63),D=a.n(W),B=a(117),F=a.n(B),V=a(62),H=a.n(V),q=a(77),z=a.n(q),K=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(o.a)(this,Object(c.a)(t).call(this,e))).handleChange=function(e){a.setState({value:e.target.value})},a.state={value:a.props.state},a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.props.classes;return i.a.createElement(k.a,{component:"fieldset",className:e.formControl},i.a.createElement(z.a,{component:"legend"},"Gender"),i.a.createElement(F.a,{row:!0,"aria-label":"Gender",name:"gender",className:e.group,value:this.state.value,onChange:this.handleChange},i.a.createElement(H.a,{value:"Female",control:i.a.createElement(D.a,null),label:"Female"}),i.a.createElement(H.a,{value:"Male",control:i.a.createElement(D.a,null),label:"Male"}),i.a.createElement(H.a,{value:"Unknown",control:i.a.createElement(D.a,null),label:"Other"})))}}]),t}(i.a.Component),J=Object(N.withStyles)(function(e){return{formControl:{width:"100%",marginTop:2*e.spacing.unit},group:{margin:0}}})(K),Y=a(47),X=a.n(Y),$=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(o.a)(this,Object(c.a)(t).call(this,e))).default_state={conpassworderror:!1,conpasswordmessage:""},a.state={conpassworderror:!1,conpasswordmessage:""},a.handleSubmit=a.handleSubmit.bind(Object(l.a)(Object(l.a)(a))),M()("#stage").hide(),a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"handleSubmit",value:function(e){var t=this;e.preventDefault();var a=new FormData(e.target),n={};this.setState(function(e,a){return t.default_state}),a.get("conpassword")===a.get("password")?(n.userid=a.get("userid"),n.password=a.get("password"),n.username=a.get("username"),n.gender=a.get("gender"),n.birthday=a.get("birthday"),A.a.post("/api/user/create",n).then(function(e){t.props.switchToMainGame(),t.props.clientGameSocket.send("login",n.userid),t.props.currentUser.setUserid(n.userid),t.props.currentUser.setPassword(n.password),t.props.getUserInfo(n.userid),t.props.handleInfo("User successfully created")}).catch(function(e){t.props.handleError(e.response.data.error)})):this.setState(function(e,t){return{conpassworderror:!0,conpasswordmessage:"Password Mismatch"}})}},{key:"render",value:function(){var e=this.props.classes;return i.a.createElement("main",{className:e.main},i.a.createElement(y.a,null),i.a.createElement(P.a,{className:e.paper},i.a.createElement("div",null,i.a.createElement(w.a,{onClick:this.props.switchToLogin},"Log In"),i.a.createElement(w.a,{onClick:this.props.switchToSignUp,color:"primary"},"Register")),i.a.createElement(f.a,{className:e.avatar},"JO"),i.a.createElement(I.a,{component:"h2",variant:"h5"},"JoJo's Royale Battle"),i.a.createElement("form",{className:e.form,onSubmit:this.handleSubmit},i.a.createElement(k.a,{margin:"normal",required:!0,fullWidth:!0},i.a.createElement(x.a,{htmlFor:"userid"},"User ID"),i.a.createElement(j.a,{id:"userid",name:"userid",autoFocus:!0})),i.a.createElement(k.a,{margin:"normal",required:!0,fullWidth:!0},i.a.createElement(x.a,{htmlFor:"username"},"User Name"),i.a.createElement(j.a,{name:"username",id:"username"})),i.a.createElement(k.a,{margin:"normal",required:!0,fullWidth:!0},i.a.createElement(x.a,{htmlFor:"password"},"Password"),i.a.createElement(j.a,{name:"password",type:"password",id:"password"})),i.a.createElement(k.a,{margin:"normal",required:!0,fullWidth:!0,error:this.state.conpassworderror},i.a.createElement(x.a,{htmlFor:"conpassword"},"Confirm Password"),i.a.createElement(j.a,{name:"conpassword",type:"password",id:"conpassword"}),i.a.createElement(X.a,null,this.state.conpasswordmessage)),i.a.createElement(J,null),i.a.createElement(k.a,{margin:"normal",required:!0,fullWidth:!0},i.a.createElement(x.a,{htmlFor:"date",required:!0,shrink:!0},"Birthday"),i.a.createElement(j.a,{name:"birthday",type:"date",id:"birthday"})),i.a.createElement(w.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:e.submit},"Sign Up"))))}}]),t}(i.a.Component),Q=C()(function(e){return{main:Object(p.a)({width:"auto",display:"block",marginLeft:3*e.spacing.unit,marginRight:3*e.spacing.unit},e.breakpoints.up(400+3*e.spacing.unit*2),{width:400,marginLeft:"auto",marginRight:"auto"}),paper:{marginTop:8*e.spacing.unit,display:"flex",flexDirection:"column",alignItems:"center",padding:"".concat(2*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px")},avatar:{margin:e.spacing.unit,backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing.unit},submit:{marginTop:3*e.spacing.unit}}})($),Z=a(26),ee=a.n(Z),te=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(o.a)(this,Object(c.a)(t).call(this,e))).currentUser=a.props.currentUser,a.clientGameSocket=a.props.clientGameSocket,a.handleStartNewGame=a.handleStartNewGame.bind(Object(l.a)(Object(l.a)(a))),a.handleLogoutButton=a.handleLogoutButton.bind(Object(l.a)(Object(l.a)(a))),M()("#stage").show(),a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"handleStartNewGame",value:function(){console.log("start",this.currentUser.info.userid),this.clientGameSocket.send("start",this.currentUser.info.userid)}},{key:"handleLogoutButton",value:function(){this.props.handleInfo("Logout successful "+this.currentUser.info.userid),this.clientGameSocket.send("logout",this.currentUser.info.userid),this.currentUser.clear(),this.props.switchToLogin()}},{key:"render",value:function(){var e=this.props.classes;return i.a.createElement("div",null,i.a.createElement(ee.a,{container:!0,className:e.root,spacing:24,alignItems:"center",justify:"center"},i.a.createElement(ee.a,{item:!0,xs:4},i.a.createElement(w.a,{className:e.button,variant:"contained",onClick:this.handleStartNewGame,fullWidth:!0},"START")),i.a.createElement(ee.a,{item:!0,xs:4},i.a.createElement(w.a,{className:e.button,variant:"contained",onClick:this.props.switchToProfile,fullWidth:!0}," PROFILE")),i.a.createElement(ee.a,{item:!0,xs:4},i.a.createElement(w.a,{className:e.button,variant:"contained",onClick:this.handleLogoutButton,fullWidth:!0},"LOG OUT"))))}}]),t}(i.a.Component),ae=C()(function(e){return{main:Object(p.a)({width:"auto",display:"block",marginLeft:3*e.spacing.unit,marginRight:3*e.spacing.unit},e.breakpoints.up(400+3*e.spacing.unit*2),{width:400,marginLeft:"auto",marginRight:"auto"}),paper:{marginTop:8*e.spacing.unit,display:"flex",flexDirection:"column",alignItems:"center",padding:"".concat(2*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px")},avatar:{margin:e.spacing.unit,backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing.unit},submit:{marginTop:3*e.spacing.unit},button:{margin:e.spacing.unit},input:{display:"none"},center:{display:"flex",alignItems:"center",justifyContent:"center"}}})(te),ne=a(64),ie=a.n(ne),re=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(o.a)(this,Object(c.a)(t).call(this,e))).default_state={conpassworderror:!1,conpasswordmessage:""},a.state={conpassworderror:!1,conpasswordmessage:""},a.handleProfileSubmit=a.handleProfileSubmit.bind(Object(l.a)(Object(l.a)(a))),a.handlePasswordSubmit=a.handlePasswordSubmit.bind(Object(l.a)(Object(l.a)(a))),a.handleDeleteUser=a.handleDeleteUser.bind(Object(l.a)(Object(l.a)(a))),M()("#stage").hide(),a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"handleProfileSubmit",value:function(e){var t=this;e.preventDefault();var a=new FormData(e.target),n={};n.userid=this.props.currentUser.info.userid,n.password=this.props.currentUser.info.password,n.username=a.get("username"),n.gender=a.get("gender"),n.birthday=a.get("birthday"),A.a.put("/api/user/"+n.userid,n).then(function(e){t.props.getUserInfo(n.userid),t.props.handleInfo("User Profile Updated Success")}).catch(function(e){t.props.handleError(e.response.data.error)})}},{key:"handlePasswordSubmit",value:function(e){var t=this;e.preventDefault();var a=new FormData(e.target),n={},i=this.props.currentUser.info.userid,r=this.props.currentUser.info.password,s=a.get("password"),o=a.get("conpassword");this.setState(function(e,a){return t.default_state}),s===o?(n.password=r,n.newpassword=s,A.a.put("/api/user/password/"+i,n).then(function(e){t.props.handleInfo("Password Updated Success"),t.props.currentUser.setPassword(s)}).catch(function(e){t.props.handleError(e.response.data.error)})):this.setState(function(e,t){return{conpassworderror:!0,conpasswordmessage:"Password Mismatch"}})}},{key:"handleDeleteUser",value:function(){var e=this;if(!0===window.confirm("You can not recover your account after deletion, click confirm to proceed")){var t=this.props.currentUser.info.userid,a=this.props.currentUser.info.password,n={};n.password=a,A.a.delete("/api/user/"+t,{data:n}).then(function(a){e.props.handleInfo("User "+t+" Deleted"),e.props.currentUser.clear(),e.props.switchToLogin()}).catch(function(t){e.props.handleError("User deletion failed")})}}},{key:"render",value:function(){var e=this.props.classes;return i.a.createElement("main",{className:e.main},i.a.createElement(y.a,null),i.a.createElement(P.a,{className:e.paper},i.a.createElement(I.a,{component:"h1",variant:"h4"},"Welcome Back, ",this.props.currentUser.info.username),i.a.createElement(I.a,{className:e.root,component:"h1",variant:"h5"},"Achievement"),i.a.createElement(ee.a,{container:!0,className:e.root,spacing:16},i.a.createElement(ee.a,{item:!0,xs:4},i.a.createElement(ie.a,{id:"standard-name",label:"User ID",className:e.textField,value:this.props.currentUser.info.userid,margin:"normal",InputProps:{readOnly:!0},variant:"outlined"})),i.a.createElement(ee.a,{item:!0,xs:4},i.a.createElement(ie.a,{id:"outlined-kill",label:"KILL",className:e.textField,value:this.props.currentUser.achievement.kill,margin:"normal",InputProps:{readOnly:!0},variant:"outlined"})),i.a.createElement(ee.a,{item:!0,xs:4},i.a.createElement(ie.a,{id:"outlined-damage",label:"DAMAGE",className:e.textField,value:this.props.currentUser.achievement.damage,margin:"normal",InputProps:{readOnly:!0},variant:"outlined"}))),i.a.createElement("form",{className:e.form,onSubmit:this.handleProfileSubmit},i.a.createElement(k.a,{margin:"normal",required:!0,fullWidth:!0},i.a.createElement(x.a,{htmlFor:"username"},"User Name"),i.a.createElement(j.a,{name:"username",id:"username",defaultValue:this.props.currentUser.info.username})),i.a.createElement(J,{state:this.props.currentUser.info.gender}),i.a.createElement(k.a,{margin:"normal",required:!0,fullWidth:!0},i.a.createElement(x.a,{htmlFor:"date",required:!0,shrink:!0},"Birthday"),i.a.createElement(j.a,{name:"birthday",type:"date",id:"birthday",defaultValue:this.props.currentUser.info.birthday})),i.a.createElement("div",null,i.a.createElement(w.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary"},"CHANGE PROFILE"))),i.a.createElement("form",{className:e.form,onSubmit:this.handlePasswordSubmit},i.a.createElement(k.a,{margin:"normal",required:!0,fullWidth:!0},i.a.createElement(x.a,{htmlFor:"password"},"Password"),i.a.createElement(j.a,{name:"password",type:"password",id:"password"})),i.a.createElement(k.a,{margin:"normal",required:!0,fullWidth:!0,error:this.state.conpassworderror},i.a.createElement(x.a,{htmlFor:"conpassword"},"Confirm Password"),i.a.createElement(j.a,{name:"conpassword",type:"password",id:"conpassword"}),i.a.createElement(X.a,null,this.state.conpasswordmessage)),i.a.createElement(ee.a,{container:!0,className:e.root,spacing:24,alignItems:"center",justify:"center"},i.a.createElement(ee.a,{item:!0,xs:6,alignItems:"center",justify:"center"},i.a.createElement(w.a,{type:"submit",variant:"contained",color:"secondary",fullWidth:!0,className:e.button},"CHANGE")),i.a.createElement(ee.a,{item:!0,xs:6,alignItems:"center",justify:"center"},i.a.createElement(w.a,{className:e.button,variant:"contained",color:"secondary",fullWidth:!0,onClick:this.handleDeleteUser}," DELETE USER")))),i.a.createElement(w.a,{className:e.buttonback,onClick:this.props.switchToMainGame},"BACK TO GAME")))}}]),t}(i.a.Component),se=C()(function(e){return{main:Object(p.a)({width:"auto",display:"block",marginLeft:3*e.spacing.unit,marginRight:3*e.spacing.unit},e.breakpoints.up(400+3*e.spacing.unit*2),{width:400,marginLeft:"auto",marginRight:"auto"}),paper:{marginTop:8*e.spacing.unit,display:"flex",flexDirection:"column",alignItems:"center",padding:"".concat(2*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px")},avatar:{margin:e.spacing.unit,backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing.unit},submit:{marginTop:3*e.spacing.unit},textField:{width:"100%",marginTop:e.spacing.unit},button:{display:"flex"},buttonback:{marginTop:2*e.spacing.unit,display:"flex"},root:{marginTop:2*e.spacing.unit}}})(re),oe=a(81),ce=a.n(oe),he=a(126),le=a(12),ue=a.n(le),de=a(118),pe=a.n(de),me=a(120),fe=a.n(me),ge=a(121),we=a.n(ge),ve=a(124),ye=a.n(ve),be=a(122),ke=a.n(be),Oe=a(123),je=a.n(Oe),Ee=a(78),xe=a.n(Ee),Se=a(79),Pe=a.n(Se),Ue=a(119),Ie=a.n(Ue),_e={success:pe.a,warning:Ie.a,error:fe.a,info:we.a};var Ce=Object(N.withStyles)(function(e){return{success:{backgroundColor:ke.a[600]},error:{backgroundColor:e.palette.error.dark},info:{backgroundColor:e.palette.primary.dark},warning:{backgroundColor:je.a[700]},icon:{fontSize:20},iconVariant:{opacity:.9,marginRight:e.spacing.unit},message:{display:"flex",alignItems:"center"}}})(function(e){var t=e.classes,a=e.className,n=e.message,r=e.onClose,s=e.variant,o=Object(he.a)(e,["classes","className","message","onClose","variant"]),c=_e[s];return i.a.createElement(Pe.a,Object.assign({className:ue()(t[s],a),"aria-describedby":"client-snackbar",message:i.a.createElement("span",{id:"client-snackbar",className:t.message},i.a.createElement(c,{className:ue()(t.icon,t.iconVariant)}),n),action:[i.a.createElement(xe.a,{key:"close","aria-label":"Close",color:"inherit",className:t.close,onClick:r},i.a.createElement(ye.a,{className:t.icon}))]},o))}),Te=a(80),Ae=a.n(Te),Ge=a(125),Me=function(){function e(t){Object(u.a)(this,e),this.url=t,this.socket=null}return Object(d.a)(e,[{key:"connect",value:function(){var e=this;return new Promise(function(t,a){var n=new WebSocket(e.url);n.onopen=function(){t(n)},n.onerror=function(e){a(e)}})}},{key:"validateServerGameSocketMessage",value:function(e){return!!e.actors}},{key:"registerEvent",value:function(){var e=Object(Ge.a)(Ae.a.mark(function e(){var t=this;return Ae.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.connect();case 3:this.socket=e.sent,this.socket.onopen=function(e){console.log("CLIENT: connected")},this.socket.onclose=function(e){alert("Unable to connect to game server, try again later.")},this.socket.onmessage=function(e){try{var a=JSON.parse(e.data)}catch(n){}t.validateServerGameSocketMessage(a)?t.game&&t.currentUser&&(t.game.world.clearWorld(),t.game.world.addServerActors(a.actors,t.currentUser.info.userid)):console.log("validateServerGameSocketMessage error")},e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log("oops ",e.t0);case 12:case"end":return e.stop()}},e,this,[[0,9]])}));return function(){return e.apply(this,arguments)}}()},{key:"send",value:function(e,t,a){var n={operation:e,userid:t,event:a},i=JSON.stringify(n);this.socket.send(i)}}]),e}(),Le=a(36);function Re(e,t){var a=e.getBoundingClientRect();return{x:t.clientX-a.x,y:t.clientY-a.y}}var Ne=function(){function e(t,a,n,i){Object(u.a)(this,e),this.x=t||0,this.y=a||0,this.width=n||0,this.height=i||0,this.right=this.x+this.width,this.bottom=this.y+this.height}return Object(d.a)(e,[{key:"set",value:function(e,t,a,n){this.x=e,this.y=t,this.width=a||this.width,this.height=n||this.height,this.right=this.x+this.width,this.bottom=this.y+this.height}},{key:"within",value:function(e){return e.x<=this.x&&e.right>=this.right&&e.y<=this.y&&e.bottom>=this.bottom}},{key:"overlaps",value:function(e){return this.x<e.right&&e.x<this.right&&this.y<e.bottom&&e.y<this.bottom}}]),e}(),We=function(){function e(t,a,n){Object(u.a)(this,e),this.x=t,this.y=a,this.radius=n}return Object(d.a)(e,[{key:"set",value:function(e,t,a){this.x=e,this.y=t,this.radius=a||this.radius}},{key:"within",value:function(e){}},{key:"overlaps",value:function(e){var t=Math.sqrt((this.x-e.x)*(this.x-e.x)+(this.y-e.y)*(this.y-e.y));return e.radius+this.radius>t}}]),e}(),De=function(){function e(){Object(u.a)(this,e)}return Object(d.a)(e,[{key:"broadDetection",value:function(e,t){}},{key:"narrowDetection",value:function(e,t){var a=e.shape,n=t.shape;return a.set(e.position.x,e.position.y),n.set(t.position.x,t.position.y),a instanceof We&&n instanceof We?a.overlaps(n):a instanceof Ne&&n instanceof Ne?a.overlaps(n):a instanceof We&&n instanceof Ne?this.circleRectOverlaps(a,n):a instanceof Ne&&n instanceof We?this.circleRectOverlaps(n,a):void 0}},{key:"circleRectOverlaps",value:function(e,t){var a=t.x+t.width/2,n=t.y+t.height/2,i=Math.abs(e.x-a),r=Math.abs(e.y-n);return!(i>t.width/2+e.radius)&&(!(r>t.height/2+e.radius)&&(i<t.width/2||(r<t.height/2||Math.pow(i-t.width/2,2)+Math.pow(r-t.height/2,2)<Math.pow(e.radius,2))))}}]),e}(),Be=function(){function e(t,a,n){Object(u.a)(this,e),this.BGCorlor=t,this.width=a,this.height=n,this.image=null}return Object(d.a)(e,[{key:"generate",value:function(e){var t=e.canvas.width,a=e.canvas.height;e.canvas.width=this.width,e.canvas.height=this.height,e.fillStyle="rgba(109,149,62, 0.5)",e.fillRect(0,0,this.width,this.height);var n=1+~~(this.width/400),i=1+~~(this.height/400),r=this.BGCorlor;e.fillStyle=r;for(var s=0,o=0;o<n;s+=400,o++){e.beginPath();for(var c=0,h=0;h<i;c+=400,h++)e.rect(s,c,396,396);e.fill(),e.closePath()}this.image=new Image,this.image.src=e.canvas.toDataURL("image/png"),e.canvas.width=t,e.canvas.height=a,e=null}},{key:"draw",value:function(e,t,a){var n,i,r=e.canvas.width,s=e.canvas.height;n=r,i=s,e.drawImage(this.image,t,a,r,s,0,0,n,i)}}]),e}(),Fe=function(){function e(t,a,n){var i=this;Object(u.a)(this,e),this.canvas=t,this.FPS=60,this.INTERVAL=1e3/this.FPS,this.STEP=this.INTERVAL/1e3,this.world=new Ve(Ut,Pt),this.world.game=this,this.world.background.generate(this.canvas.getContext("2d")),this.viewport=new He(t,0,0,Ut,Pt),this.gameMainLoopRequestid=null,this.mainPlayer=null,this.currentUser=a,this.clientGameSocket=n,this.canvas.getContext&&(window.addEventListener("resize",function(){i.resizeCanvas()},!1),window.addEventListener("orientationchange",function(){i.resizeCanvas()},!1)),this.resizeCanvas()}return Object(d.a)(e,[{key:"resizeCanvas",value:function(){this.canvas.width=window.innerWidth-50,this.canvas.height=window.innerHeight-70}},{key:"setMainPlayer",value:function(e){this.world.addPlayer(e),this.viewport.follow(e),this.mainPlayer=e}},{key:"unsetMainPlayer",value:function(){this.viewport.follow(null),this.mainPlayer=null}},{key:"step",value:function(){this.resizeCanvas(),this.viewport.update()}},{key:"draw",value:function(){var e=this.canvas.getContext("2d");this.world.draw(e,this.viewport.xView,this.viewport.yView)}},{key:"loop",value:function(){var e=this;this.step(),this.draw(),this.gameMainLoopRequestid=requestAnimationFrame(function(){e.loop()})}},{key:"start",value:function(){this.loop()}},{key:"end",value:function(){cancelAnimationFrame(this.gameMainLoopRequestid),this.gameMainLoopRequestid=null,this.draw()}},{key:"setPlayerEventListener",value:function(){var e=this;window.addEventListener("keydown",function(t){var a=e.currentUser.info.userid,n={type:"keydown"};n.keyCode=t.keyCode,a&&e.clientGameSocket.send("event",a,n)}),window.addEventListener("keyup",function(t){var a=e.currentUser.info.userid,n={type:"keyup"};n.keyCode=t.keyCode,a&&e.clientGameSocket.send("event",a,n)}),this.canvas.addEventListener("mousemove",function(t){var a=e.currentUser.info.userid,n=e.mainPlayer;if(a&&n){var i=function(e,t){var a=e.getBoundingClientRect();return{x:t.clientX-a.x,y:t.clientY-a.y}}(e.canvas,t),r=e.mainPlayer.position.x,s=e.mainPlayer.position.y,o=i.x+e.viewport.xView,c=i.y+e.viewport.yView,h=new qe(o-r,c-s),l={type:"mousemove"};l.direction=h,e.clientGameSocket.send("event",a,l)}}),this.canvas.addEventListener("touchmove",function(t){t.preventDefault();var a=e.currentUser.info.userid,n=e.mainPlayer;if(a&&n){var i=t.touches[0],r=Re(e.canvas,i),s=e.mainPlayer.position.x,o=e.mainPlayer.position.y,c=r.x+e.viewport.xView,h=r.y+e.viewport.yView,l=new qe(c-s,h-o),u={type:"mousemove"};u.direction=l,e.clientGameSocket.send("event",a,u)}}),this.canvas.addEventListener("mousedown",function(t){var a=e.currentUser.info.userid,n={type:"mousedown"};a&&e.clientGameSocket.send("event",a,n)}),this.canvas.addEventListener("mouseup",function(t){var a=e.currentUser.info.userid,n={type:"mouseup"};a&&e.clientGameSocket.send("event",a,n)});var t=!1;function a(e){return Math.round(e)}if(this.canvas.addEventListener("touchstart",function(a){a.preventDefault();var n=e.currentUser.info.userid;if(n){if(function(a){if(!t)return t=!0,setTimeout(function(){t=!1},300),!1;a.preventDefault();var n=e.currentUser.info.userid,i={type:"keydown",keyCode:82};return n&&e.clientGameSocket.send("event",n,i),!0}(a))return;if(2===a.touches.length){var i={type:"keydown",keyCode:70};return void e.clientGameSocket.send("event",n,i)}var r={type:"mousedown"},s=a.touches[0],o=Re(e.canvas,s),c=e.mainPlayer.position.x,h=e.mainPlayer.position.y,l=o.x+e.viewport.xView,u=o.y+e.viewport.yView,d=new qe(l-c,u-h);r.direction=d,e.clientGameSocket.send("event",n,r)}}),this.canvas.addEventListener("touchend",function(t){t.preventDefault();var a={type:"mouseup"},n=e.currentUser.info.userid;n&&e.clientGameSocket.send("event",n,a)}),window.DeviceMotionEvent){var n=!1,i=!1,r=!1,s=!1;console.log("DeviceMotionEvent supported"),window.ondevicemotion=function(t){t.preventDefault();var o=e.currentUser.info.userid,c=e.mainPlayer;if(o){var h={},l=a(t.accelerationIncludingGravity.x),u=a(t.accelerationIncludingGravity.y);if(l<=-2?n||(h.type="keydown",h.keyCode=65,e.clientGameSocket.send("event",o,h),n=!0):n&&(h.type="keyup",h.keyCode=65,e.clientGameSocket.send("event",o,h),n=!1),l>=2?i||(h.type="keydown",h.keyCode=68,e.clientGameSocket.send("event",o,h),i=!0):i&&(h.type="keyup",h.keyCode=68,e.clientGameSocket.send("event",o,h),i=!1),u<=-2?s||(h.type="keydown",h.keyCode=83,e.clientGameSocket.send("event",o,h),s=!0):s&&(h.type="keyup",h.keyCode=83,e.clientGameSocket.send("event",o,h),s=!1),u>=2?r||(h.type="keydown",h.keyCode=87,e.clientGameSocket.send("event",o,h),r=!0):r&&(h.type="keyup",h.keyCode=87,e.clientGameSocket.send("event",o,h),r=!1),!c){var d=a(t.acceleration.x),p=a(t.acceleration.y),m=a(t.acceleration.z);(d>14||p>14||m>14)&&e.clientGameSocket.send("start",o)}}}}}}]),e}(),Ve=function(){function e(t,a){Object(u.a)(this,e),this.width=t,this.height=a,this.actors={},this.background=new Be("rgb(128, 175, 71)",this.width,this.height),this.collisionDetector=new De,this.images={crate:document.getElementById("crate"),goldenCrate:document.getElementById("goldenCrate"),house:document.getElementById("house1"),mansion:document.getElementById("mansion"),stone1:document.getElementById("stone1"),stone2:document.getElementById("stone2"),bed:document.getElementById("bed1"),tree1:document.getElementById("tree1"),bush1:document.getElementById("bush1"),toilet:document.getElementById("toilet")},this.playerCount=0}return Object(d.a)(e,[{key:"clearWorld",value:function(){this.actors={},this.playerCount=0}},{key:"addServerActors",value:function(e,t){if(this.game.currentUser.info.userid)for(var a in this.game.unsetMainPlayer(),e)for(var n=e[a],i=0;i<n.length;i++){var r=n[i],s=new qe(r.position.x,r.position.y),o=null;switch(a){case"Floor":o=new St(this,s,r.shape.height,r.shape.width,r.colour),this.addActor(o);break;case"Projectile_556":o=new rt(this,s),this.addActor(o);break;case"Projectile_762":o=new st(this,s),this.addActor(o);break;case"Projectile_shotGunShell":o=new it(this,s),this.addActor(o);break;case"Ammo_556":o=new ct(this,s),this.addActor(o);break;case"Ammo_762":o=new ht(this,s),this.addActor(o);break;case"Ammo_shotGunShell":o=new lt(this,s),this.addActor(o);break;case"Weapon_AK47":o=new tt(this,s),this.addActor(o);break;case"Weapon_M416":o=new et(this,s),this.addActor(o);break;case"Weapon_S686":o=new at(this,s),this.addActor(o);break;case"Player":if(this.playerCount+=1,(o=new Je(this,s,r.speed,r.width,r.height,r.color)).changeDirection(r.direction),o.inventory=r.inventory,o.healthPoint=r.healthPoint,o.id=r.id,r.curr_weapon){var c=new Ze(this,r.curr_weapon.position,r.curr_weapon.shape,r.curr_weapon.ammo,r.curr_weapon.max_ammo,null,null,null,null,r.curr_weapon.colour);c.name=r.curr_weapon.name,o.curr_weapon=c}if(r.id===this.game.currentUser.info.userid){this.game.setMainPlayer(o);break}this.addActor(o);break;case"aimbotAI":case"randomAI":break;case"circleWall":o=new dt(this,s,r.shape.radius),this.addActor(o);break;case"rectWall":o=new pt(this,s,r.shape.height,r.shape.width),this.addActor(o);break;case"Crate":o=new yt(this,s,r.shape.height,r.shape.width),this.addActor(o);break;case"goldenCrate":o=new Ot(this,s,r.shape.height,r.shape.width),this.addActor(o);break;case"Stone":o=new ft(this,s,r.shape.radius),this.addActor(o);break;case"Tree":o=new gt(this,s,r.shape.radius),this.addActor(o);break;case"Bush":o=new wt(this,s,r.shape.radius),this.addActor(o);break;case"Bed":o=new bt(this,s,r.shape.height,r.shape.width),this.addActor(o);break;case"Toilet":o=new kt(this,s,r.shape.height,r.shape.width),this.addActor(o);break;case"House":o=new Et(this,s,r.shape.height,r.shape.width),this.game.mainPlayer&&o.detectPlayer(this.game.mainPlayer),this.addActor(o);break;case"Mansion":o=new xt(this,s,r.shape.height,r.shape.width),this.game.mainPlayer&&o.detectPlayer(this.game.mainPlayer),this.addActor(o)}}}},{key:"addPlayer",value:function(e){this.addActor(e),this.player=e}},{key:"removePlayer",value:function(){this.player&&(this.removeActor(this.player),this.player=null)}},{key:"addActor",value:function(e){void 0===this.actors[e.constructor.name]&&(this.actors[e.constructor.name]=[]),this.actors[e.constructor.name].push(e)}},{key:"removeActor",value:function(e){var t=this.actors[e.constructor.name].indexOf(e);-1!==t&&this.actors[e.constructor.name].splice(t,1)}},{key:"step",value:function(e){}},{key:"draw",value:function(e,t,a){var n=e.canvas.width,i=e.canvas.height;e.clearRect(0,0,this.width,this.height),e.save(),this.background.draw(e,t,a),e.restore();for(var r in this.actors)for(var s=this.actors[r],o=0;o<s.length;o++)t-500<s[o].position.x&&s[o].position.x<t+n+500&&a-500<s[o].position.y&&s[o].position.y<500+a+i&&(e.save(),s[o].draw(e,t,a),e.restore());this.game.mainPlayer&&this.game.mainPlayer.hud.draw(e,t,a)}},{key:"getPlayerNum",value:function(){return this.playerCount}}]),e}(),He=function(){function e(t,a,n,i,r){Object(u.a)(this,e),this.canvas=t,this.world_width=i,this.world_height=r,this.xView=a,this.yView=n,this._followed=null,this.vpRect=new Ne(this.xView,this.yView,this.canvas.width,this.canvas.height),this.worldRect=new Ne(0,0,this.world_width,this.world_height)}return Object(d.a)(e,[{key:"follow",value:function(e){this.followed=e}},{key:"update",value:function(){if(this.followed){var e=this.followed.position.x,t=this.followed.position.y,a=this.canvas.width,n=this.canvas.height;this.xView=e-a/2,this.yView=t-n/2,this.vpRect.set(this.xView,this.yView,a,n),this.vpRect.within(this.worldRect)||(this.vpRect.x<this.worldRect.x&&(this.xView=this.worldRect.x),this.vpRect.y<this.worldRect.y&&(this.yView=this.worldRect.y),this.vpRect.right>this.worldRect.right&&(this.xView=this.worldRect.right-a),this.vpRect.bottom>this.worldRect.bottom&&(this.yView=this.worldRect.bottom-n))}}},{key:"followed",get:function(){return this._followed},set:function(e){this._followed=e}}]),e}(),qe=function(){function e(t,a){Object(u.a)(this,e),this.x=t,this.y=a}return Object(d.a)(e,[{key:"toString",value:function(){return"("+this.x+","+this.y+")"}},{key:"set",value:function(e,t){this.x=e,this.y=t}},{key:"normalize",value:function(e){var t=Math.sqrt(this.x*this.x+this.y*this.y);this.x=this.x/t*e,this.y=this.y/t*e}},{key:"distance",value:function(e){var t=e.x-this.x,a=e.y-this.y;return Math.sqrt(t*t+a*a)}},{key:"directionOf",value:function(t){return new e(t.x-this.x,t.y-this.y)}}]),e}(),ze=function(){function e(t,a,n){Object(u.a)(this,e),this.world=t,this.position=a,this.shape=n}return Object(d.a)(e,[{key:"toString",value:function(){}},{key:"step",value:function(e){throw"Not Implemented Yet"}},{key:"draw",value:function(e,t,a){this.shape instanceof Ne?(e.translate(-t,-a),e.fillRect(this.position.x,this.position.y,this.shape.width,this.shape.height)):this.shape instanceof We&&(e.beginPath(),e.arc(this.position.x-t,this.position.y-a,this.shape.radius,0,2*Math.PI,!1),e.closePath(),e.fill())}},{key:"setPosition",value:function(e,t){this.position.x=e,this.position.y=t,this.shape.x=e,this.shape.y=t}}]),e}(),Ke=function(){function e(){Object(u.a)(this,e),this._left=!1,this._up=!1,this._right=!1,this._down=!1,this._fire=!1}return Object(d.a)(e,[{key:"fire",get:function(){return this._fire},set:function(e){this._fire=e}},{key:"left",get:function(){return this._left},set:function(e){this._left=e}},{key:"up",get:function(){return this._up},set:function(e){this._up=e}},{key:"right",get:function(){return this._right},set:function(e){this._right=e}},{key:"down",get:function(){return this._down},set:function(e){this._down=e}}]),e}(),Je=function(e){function t(e,a,n,i,r,s){var h;Object(u.a)(this,t);var d=new We(a.x,a.y,i);return(h=Object(o.a)(this,Object(c.a)(t).call(this,e,a,d))).speed=n,h.controls=new Ke,h.width=i,h.height=r,h.color=s,h.inventory={Projectile_556:100,Projectile_762:100,Projectile_shotGunShell:100},h.direction=new qe(a.x,a.y),h.weapon1=null,h.weapon2=null,h.curr_weapon=null,h.healthPoint=100,h.maxHealthPoint=100,h.hud=new Ye(Object(l.a)(Object(l.a)(h))),h.stats=new Xe(Object(l.a)(Object(l.a)(h))),h}return Object(h.a)(t,e),Object(d.a)(t,[{key:"resetPlayer",value:function(){this.weapon1=null,this.weapon2=null,this.curr_weapon=null,this.healthPoint=100,this.inventory={Projectile_556:100,Projectile_762:100,Projectile_shotGunShell:100}}},{key:"pickup",value:function(){for(var e=this.world.getActorApproByType(this,_t),t=0;t<e.length;t++)return void this.addAmmo(e[t]);for(var a=this.world.getActorApproByType(this,It),n=0;n<a.length;n++)return void this.assignWeapon(a[n])}},{key:"addAmmo",value:function(e){this.world.removeActor(e),this.inventory[e.ammo_type.name]?this.inventory[e.ammo_type.name]+=e.ammo:this.inventory[e.ammo_type.name]=e.ammo}},{key:"switchWeapon",value:function(e){1!==e?2===e&&(this.curr_weapon=this.weapon2):this.curr_weapon=this.weapon1}},{key:"assignWeapon",value:function(e){if(e.owner=this,this.world.removeActor(e),!this.weapon1)return this.weapon1=e,void(this.curr_weapon=this.weapon1);if(!this.weapon2)return this.weapon2=e,void(this.curr_weapon=this.weapon2);if(this.curr_weapon===this.weapon1)return this.world.addActor(this.weapon1),this.weapon1.owner=null,this.weapon1=e,void(this.curr_weapon=this.weapon1);if(this.curr_weapon===this.weapon2)return this.world.addActor(this.weapon2),this.weapon2.owner=null,this.weapon2=e,void(this.curr_weapon=this.weapon2);throw"assign weapon error"}},{key:"reload",value:function(){if(this.curr_weapon&&this.inventory[this.curr_weapon.ammo_type.name]){var e=this.inventory[this.curr_weapon.ammo_type.name];this.inventory[this.curr_weapon.ammo_type.name]=this.curr_weapon.reload(e)}}},{key:"shot",value:function(){this.curr_weapon&&this.curr_weapon.fire(this.direction)}},{key:"changeDirection",value:function(e){this.direction.x=e.x,this.direction.y=e.y,this.direction.normalize(1)}},{key:"takeDamage",value:function(e){0!=this.healthPoint&&(this.healthPoint=this.healthPoint-e<0?0:this.healthPoint-e)}},{key:"isDie",value:function(){return this.healthPoint<=0}},{key:"draw",value:function(e,t,a){var n=function(e,t,a,n){var i=n-t,r=a-e;return Math.atan2(i,r)}(this.position.x,this.position.y,this.position.x+this.direction.x,this.position.y+this.direction.y);e.translate(this.position.x-t,this.position.y-a),e.fillStyle="rgb(0,0,0)",e.font="15px Arial",e.fillText(this.id,-10,40),e.fillStyle=this.color,e.strokeStyle="rgb(0,0,0)",e.lineWidth=4,e.rotate(n),e.beginPath(),e.arc(0,0,this.shape.radius,0,2*Math.PI,!1),e.stroke(),e.fill(),e.closePath(),this.drawWeapon(e,this.position.x-25,this.position.y)}},{key:"drawWeapon",value:function(e,t,a){this.curr_weapon?(e.beginPath(),e.arc(this.width+3,-3,5,0,2*Math.PI,!1),e.fill(),e.stroke(),e.closePath(),e.beginPath(),e.arc(this.width+23,10,5,0,2*Math.PI,!1),e.stroke(),e.fill(),e.closePath(),this.curr_weapon.draw(e,t,a)):(e.beginPath(),e.arc(this.width,this.height,5,0,2*Math.PI,!1),e.stroke(),e.fill(),e.closePath(),e.beginPath(),e.arc(this.width,-this.height,5,0,2*Math.PI,!1),e.stroke(),e.fill(),e.closePath())}},{key:"toStringHealthPoint",value:function(){return this.healthPoint+"/"+this.maxHealthPoint}}]),t}(ze),Ye=function(){function e(t){Object(u.a)(this,e),this.player=t}return Object(d.a)(e,[{key:"draw",value:function(e,t,a){e.save(),this.drawAmmoHud(e,t,a),e.restore(),e.save(),this.drawHeathBarHud(e,t,a),e.restore(),e.save(),this.drawInventoryHud(e,t,a),e.restore(),e.save(),this.drawMiniMap(e,t,a),e.restore()}},{key:"drawInventoryHud",value:function(e,t,a){var n=e.canvas.width,i=0;for(var r in this.player.inventory)i++;for(var s in e.strokeStyle="rgb(0,0,0)",e.fillStyle="rgba(255,255,255,0.3)",e.beginPath(),e.rect(n-150,0,150,20*(i+1)),e.stroke(),e.closePath(),e.fillRect(n-150,0,150,20*(i+1)),i=0,e.font="15px Arial",e.fillStyle="rgb(0,0,0)",this.player.inventory)e.fillText(Ct[s]+" -> "+this.player.inventory[s],n-150+5,20*(i+1)),i++}},{key:"drawHeathBarHud",value:function(e,t,a){var n=e.canvas.height,i=this.player.healthPoint/this.player.maxHealthPoint*200;e.fillStyle="rgb(0,255,0)",e.fillRect(0,n-30,i,30),e.fillStyle="rgb(0,0,0)",e.font="30px Arial",e.fillText(this.player.toStringHealthPoint(),0,n-30+25),e.strokeStyle="rgb(0,0,0)",e.beginPath(),e.rect(0,n-30,200,30),e.stroke()}},{key:"drawAmmoHud",value:function(e,t,a){var n=e.canvas.width,i=e.canvas.height;e.fillStyle="rgbA(255,255,255, 0.1)",e.strokeStyle="rgb(0,0,0)",e.beginPath(),e.rect(n-200,i-100,200,100),e.stroke(),e.fill(),e.font="30px Arial",e.fillStyle="rgb(0,0,0)",this.player.curr_weapon&&(e.fillText(this.player.curr_weapon.toString(),n-200+5,i-100+30),e.fillText(""+this.player.curr_weapon.toAmmo(),n-200+5,i-100+60))}},{key:"drawMiniMap",value:function(e,t,a){e.canvas.width,e.canvas.height;e.fillStyle="rgbA(255,255,255, 0.1)",e.strokeStyle="rgb(0,0,0)",e.beginPath(),e.rect(0,0,200,50),e.stroke(),e.fill(),e.font="20px Arial",e.fillStyle="rgb(0,0,0)",e.fillText("Player Nearby: "+(this.player.world.getPlayerNum()-1),5,30)}}]),e}(),Xe=function(){function e(t){Object(u.a)(this,e),this.damageTaken=0,this.damageDone=0,this.kill=0,this.killList=[],this.killed=null}return Object(d.a)(e,[{key:"recordDamageTaken",value:function(e){this.damageTaken+=e}},{key:"recordDamageDone",value:function(e){this.damageDone+=e}},{key:"recordKill",value:function(e){this.kill+=1,this.killList.push(e)}},{key:"recordKilled",value:function(e){this.killed=e}}]),e}(),$e=function(e){function t(){return Object(u.a)(this,t),Object(o.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(h.a)(t,e),t}(ze),Qe=function(e){function t(e,a,n){var i;return Object(u.a)(this,t),(i=Object(o.a)(this,Object(c.a)(t).call(this,e,a,n))).player=null,i}return Object(h.a)(t,e),Object(d.a)(t,[{key:"assignPlayer",value:function(e){this.player=e}}]),t}(ze),Ze=function(e){function t(e,a,n,i,r,s,h,l,d,p,m,f){var g;return Object(u.a)(this,t),(g=Object(o.a)(this,Object(c.a)(t).call(this,e,a,n))).ammo=i,g.max_ammo=r,g.damage=s,g.speed=h,g.firerate=l,g.readytofire=!0,g.ammo_type=d,g.colour=p,g.range=f,g.owner=m,g.name=null,g}return Object(h.a)(t,e),Object(d.a)(t,[{key:"toString",value:function(){return this.name}},{key:"toAmmo",value:function(){return this.ammo+"/"+this.max_ammo}},{key:"draw",value:function(e,t,a){e.translate(-t,-a),e.fillStyle=this.colour,e.fillRect(this.position.x,this.position.y,this.shape.width,this.shape.height),e.strokeStyle="rgb(0,0,0)",e.lineWidth=2,e.beginPath(),e.rect(this.position.x,this.position.y,this.shape.width,this.shape.height),e.closePath(),e.stroke()}}]),t}(Qe),et=function(e){function t(e,a,n){Object(u.a)(this,t);var i=new Ne(a.x,a.y,30,6),r=rt;return Object(o.a)(this,Object(c.a)(t).call(this,e,a,i,30,30,20,1800,50,r,"rgb(255,0,0)",n,2e3))}return Object(h.a)(t,e),t}(Ze),tt=function(e){function t(e,a,n){Object(u.a)(this,t);var i=new Ne(a.x,a.y,30,6),r=st;return Object(o.a)(this,Object(c.a)(t).call(this,e,a,i,30,30,20,1400,30,r,"rgb(0,255,0)",n,1e3))}return Object(h.a)(t,e),t}(Ze),at=function(e){function t(e,a,n){Object(u.a)(this,t);var i=new Ne(a.x,a.y,30,6),r=it;return Object(o.a)(this,Object(c.a)(t).call(this,e,a,i,5,5,40,800,500,r,"rgb(0,0,255)",n,800))}return Object(h.a)(t,e),t}(Ze),nt=function(e){function t(e,a,n,i,r,s,h,l,d){var p;return Object(u.a)(this,t),(p=Object(o.a)(this,Object(c.a)(t).call(this,e,a,n))).speed=r,p.colour=s,p.owner=h,p.damage=l,p.range=d,p}return Object(h.a)(t,e),Object(d.a)(t,[{key:"draw",value:function(e,a,n){e.fillStyle=this.colour,e.strokeStyle="rgb(0,0,0)",e.lineWidth=4,e.beginPath(),e.rect(this.position.x,this.position.y,this.shape.width,this.shape.height),e.closePath(),e.stroke(),Object(Le.a)(Object(c.a)(t.prototype),"draw",this).call(this,e,a,n)}}]),t}($e),it=function(e){function t(e,a,n,i,r,s,h){Object(u.a)(this,t);var l=new We(a.x,a.y,5);return Object(o.a)(this,Object(c.a)(t).call(this,e,a,l,n,i,"rgb(0,0,255)",r,s,h))}return Object(h.a)(t,e),t}(nt),rt=function(e){function t(e,a,n,i,r,s,h){Object(u.a)(this,t);var l=new We(a.x,a.y,5);return Object(o.a)(this,Object(c.a)(t).call(this,e,a,l,n,i,"rgb(255,0,0)",r,s,h))}return Object(h.a)(t,e),t}(nt),st=function(e){function t(e,a,n,i,r,s,h){Object(u.a)(this,t);var l=new We(a.x,a.y,5);return Object(o.a)(this,Object(c.a)(t).call(this,e,a,l,n,i,"rgb(0,255,0)",r,s,h))}return Object(h.a)(t,e),t}(nt),ot=function(e){function t(e,a,n,i,r,s){var h;return Object(u.a)(this,t),(h=Object(o.a)(this,Object(c.a)(t).call(this,e,a,n))).ammo_type=i,h.ammo=r,h.colour=s,h}return Object(h.a)(t,e),Object(d.a)(t,[{key:"step",value:function(e){}},{key:"draw",value:function(e,t,a){e.fillStyle=this.colour,e.strokeStyle="rgb(0,0,0)",e.lineWidth=1,e.beginPath(),e.arc(this.position.x-t,this.position.y-a,this.shape.radius,0,2*Math.PI,!1),e.closePath(),e.fill(),e.stroke(),e.beginPath(),e.arc(this.position.x-t,this.position.y-a,this.shape.radius/2,0,2*Math.PI,!1),e.stroke(),e.closePath()}}]),t}(Qe),ct=function(e){function t(e,a,n){Object(u.a)(this,t);var i=new We(a.x,a.y,10),r=rt;return Object(o.a)(this,Object(c.a)(t).call(this,e,a,i,r,n,"rgb(255,0,0)"))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"draw",value:function(e,a,n){Object(Le.a)(Object(c.a)(t.prototype),"draw",this).call(this,e,a,n)}}]),t}(ot),ht=function(e){function t(e,a,n){Object(u.a)(this,t);var i=new We(a.x,a.y,10),r=st;return Object(o.a)(this,Object(c.a)(t).call(this,e,a,i,r,n,"rgb(0,255,0)"))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"draw",value:function(e,a,n){Object(Le.a)(Object(c.a)(t.prototype),"draw",this).call(this,e,a,n)}}]),t}(ot),lt=function(e){function t(e,a,n){Object(u.a)(this,t);var i=new We(a.x,a.y,10),r=it;return Object(o.a)(this,Object(c.a)(t).call(this,e,a,i,r,n,"rgb(0,0,255)"))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"draw",value:function(e,a,n){Object(Le.a)(Object(c.a)(t.prototype),"draw",this).call(this,e,a,n)}}]),t}(ot),ut=function(e){function t(e,a,n,i){var r;return Object(u.a)(this,t),(r=Object(o.a)(this,Object(c.a)(t).call(this,e,a,n))).colour=i,r}return Object(h.a)(t,e),Object(d.a)(t,[{key:"step",value:function(e){}}]),t}(function(e){function t(){return Object(u.a)(this,t),Object(o.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"step",value:function(e){}}]),t}($e)),dt=function(e){function t(e,a,n){var i;Object(u.a)(this,t);var r=new We(a.x,a.y,n);return(i=Object(o.a)(this,Object(c.a)(t).call(this,e,a,r))).colour="rgb(153, 102, 0)",i}return Object(h.a)(t,e),Object(d.a)(t,[{key:"draw",value:function(e,t,a){e.fillStyle=this.colour,e.strokeStyle="rgb(0,0,0)",e.lineWidth=4,e.translate(-t,-a),e.beginPath(),e.arc(this.position.x,this.position.y,this.shape.radius,0,2*Math.PI,!1),e.closePath(),e.fill(),e.beginPath(),e.arc(this.position.x,this.position.y,this.shape.radius,0,2*Math.PI,!1),e.closePath(),e.stroke()}}]),t}(ut),pt=function(e){function t(e,a,n,i){var r;Object(u.a)(this,t);var s=new Ne(a.x,a.y,i,n);return(r=Object(o.a)(this,Object(c.a)(t).call(this,e,a,s))).colour="rgb(153, 102, 0)",r}return Object(h.a)(t,e),Object(d.a)(t,[{key:"draw",value:function(e,t,a){e.translate(-t,-a),e.strokeStyle="rgb(0,0,0)",e.lineWidth=4,e.fillStyle=this.colour,e.beginPath(),e.rect(this.position.x,this.position.y,this.shape.width,this.shape.height),e.closePath(),e.fill(),e.beginPath(),e.rect(this.position.x,this.position.y,this.shape.width,this.shape.height),e.closePath(),e.stroke()}}]),t}(ut),mt=function(e){function t(e,a,n,i,r){var s;return Object(u.a)(this,t),(s=Object(o.a)(this,Object(c.a)(t).call(this,e,a,n,i))).maxHealthPoint=r,s.healthPoint=s.maxHealthPoint,s.original_shape=new We(a.x,a.y,n),s}return Object(h.a)(t,e),Object(d.a)(t,[{key:"draw",value:function(e,t,a){if(e.translate(-t,-a),this.image){var n=this.shape.radius;e.drawImage(this.image,this.position.x-n,this.position.y-n,2*this.shape.radius,2*this.shape.radius)}else e.fillStyle=this.colour,e.beginPath(),e.arc(this.position.x,this.position.y,this.shape.radius,0,2*Math.PI,!1),e.closePath(),e.fill()}},{key:"setPosition",value:function(e,a){this.original_shape.set(e,a,void 0),Object(Le.a)(Object(c.a)(t.prototype),"setPosition",this).call(this,e,a)}}]),t}(dt),ft=function(e){function t(e,a,n,i,r){var s;return Object(u.a)(this,t),(s=Object(o.a)(this,Object(c.a)(t).call(this,e,a,n,i,r))).image=s.world.images.stone1,s}return Object(h.a)(t,e),t}(mt),gt=function(e){function t(e,a,n,i,r){var s;return Object(u.a)(this,t),(s=Object(o.a)(this,Object(c.a)(t).call(this,e,a,n,i,r))).image=s.world.images.tree1,s}return Object(h.a)(t,e),t}(mt),wt=function(e){function t(e,a,n,i,r){var s;return Object(u.a)(this,t),(s=Object(o.a)(this,Object(c.a)(t).call(this,e,a,n,i,r))).image=s.world.images.bush1,s}return Object(h.a)(t,e),t}(mt),vt=function(e){function t(e,a,n,i,r,s){var h;return Object(u.a)(this,t),(h=Object(o.a)(this,Object(c.a)(t).call(this,e,a,n,i,r))).maxHealthPoint=s,h.healthPoint=h.maxHealthPoint,h.original_shape=new Ne(a.x,a.y,i,n),h}return Object(h.a)(t,e),Object(d.a)(t,[{key:"draw",value:function(e,t,a){e.translate(-t,-a),this.image?e.drawImage(this.image,this.position.x,this.position.y,this.shape.width,this.shape.height):(e.fillStyle=this.colour,e.fillRect(this.position.x,this.position.y,this.shape.width,this.shape.height))}}]),t}(pt),yt=function(e){function t(e,a,n,i,r,s){var h;return Object(u.a)(this,t),(h=Object(o.a)(this,Object(c.a)(t).call(this,e,a,n,i,r,s))).image=h.world.images.crate,h}return Object(h.a)(t,e),t}(vt),bt=function(e){function t(e,a,n,i,r,s){var h;return Object(u.a)(this,t),(h=Object(o.a)(this,Object(c.a)(t).call(this,e,a,n,i,r,s))).image=h.world.images.bed,h}return Object(h.a)(t,e),t}(vt),kt=function(e){function t(e,a,n,i,r,s){var h;return Object(u.a)(this,t),(h=Object(o.a)(this,Object(c.a)(t).call(this,e,a,n,i,r,s))).image=h.world.images.toilet,h}return Object(h.a)(t,e),t}(vt),Ot=function(e){function t(e,a,n,i,r,s){var h;return Object(u.a)(this,t),(h=Object(o.a)(this,Object(c.a)(t).call(this,e,a,n,i,r,s))).image=h.world.images.goldenCrate,h}return Object(h.a)(t,e),t}(vt),jt=function(e){function t(e,a,n,i){var r;Object(u.a)(this,t);var s=new Ne(a.x,a.y,i,n);return(r=Object(o.a)(this,Object(c.a)(t).call(this,e,a,s))).image=null,r.colour="rgb(0,0,0)",r.show=!0,r.wall_width=15,r}return Object(h.a)(t,e),Object(d.a)(t,[{key:"detectPlayer",value:function(e){this.show=!this.world.collisionDetector.narrowDetection(e,this)}},{key:"draw",value:function(e,t,a){e.translate(-t,-a),this.show&&e.drawImage(this.image,this.position.x,this.position.y,this.shape.width,this.shape.height)}}]),t}($e),Et=function(e){function t(e,a,n,i){var r;return Object(u.a)(this,t),(r=Object(o.a)(this,Object(c.a)(t).call(this,e,a,n,i))).image=r.world.images.house,r}return Object(h.a)(t,e),t}(jt),xt=function(e){function t(e,a,n,i){var r;return Object(u.a)(this,t),(r=Object(o.a)(this,Object(c.a)(t).call(this,e,a,n,i))).image=r.world.images.mansion,r}return Object(h.a)(t,e),t}(jt),St=function(e){function t(e,a,n,i,r){var s;Object(u.a)(this,t);var h=new Ne(a.x,a.y,i,n);return(s=Object(o.a)(this,Object(c.a)(t).call(this,e,a,h))).colour=r,s}return Object(h.a)(t,e),Object(d.a)(t,[{key:"draw",value:function(e,t,a){e.translate(-t,-a);var n=this.colour;e.fillStyle=n,e.fillRect(this.position.x,this.position.y,this.shape.width,this.shape.height)}},{key:"step",value:function(e){}}]),t}($e),Pt=3e3,Ut=3e3,It=["Weapon_M416","Weapon_AK47","Weapon_S686"],_t=["Ammo_556","Ammo_762","Ammo_shotGunShell"],Ct={Projectile_556:"Ammo 556",Projectile_762:"Ammo 762",Projectile_shotGunShell:"ShotGun Shell",Weapon_AK47:"AK47",Weapon_M416:"M416",Weapon_S686:"S686"},Tt=Fe,At=function(){function e(){Object(u.a)(this,e),this.info={userid:null,username:null,password:null,gender:null,birthday:null},this.achievement={kill:0,damage:0}}return Object(d.a)(e,[{key:"setInfo",value:function(e){for(var t in e)e.hasOwnProperty(t)&&(this.info[t]=e[t])}},{key:"setAchievement",value:function(e){for(var t in e)e.hasOwnProperty(t)&&(this.achievement[t]=e[t])}},{key:"setUserid",value:function(e){this.info.userid=e}},{key:"setPassword",value:function(e){this.info.password=e}},{key:"clear",value:function(){this.info={userid:null,username:null,password:null,gender:null,birthday:null},this.achievement={kill:0,damage:0}}}]),e}(),Gt=function(e){function t(e){var a;Object(u.a)(this,t),(a=Object(o.a)(this,Object(c.a)(t).call(this,e))).state={state:"login",error:!1,errorMessage:"",info:!1,infoMessage:""},a.currentUser=new At;var n=document.location.hostname,i=document.location.port;return i||(i="80"),console.log("ws://"+n+":"+(i+1)),a.clientGameSocket=new Me("ws://"+n+":"+(parseInt(i,10)+1)),a.clientGameSocket.registerEvent().then(function(){console.log("CLIENT: client socket open")}),a.game=new Tt(document.getElementById("stage"),a.currentUser,a.clientGameSocket),a.game.setPlayerEventListener(),a.game.step(),a.game.draw(),a.game.start(),a.clientGameSocket.game=a.game,a.clientGameSocket.currentUser=a.currentUser,a.switchToLogin=a.switchToLogin.bind(Object(l.a)(Object(l.a)(a))),a.switchToSignUp=a.switchToSignUp.bind(Object(l.a)(Object(l.a)(a))),a.switchToMainGame=a.switchToMainGame.bind(Object(l.a)(Object(l.a)(a))),a.switchToProfile=a.switchToProfile.bind(Object(l.a)(Object(l.a)(a))),a.getUserInfo=a.getUserInfo.bind(Object(l.a)(Object(l.a)(a))),a.handleError=a.handleError.bind(Object(l.a)(Object(l.a)(a))),a.handleErrorClose=a.handleErrorClose.bind(Object(l.a)(Object(l.a)(a))),a.handleInfo=a.handleInfo.bind(Object(l.a)(Object(l.a)(a))),a.handleInfoClose=a.handleInfoClose.bind(Object(l.a)(Object(l.a)(a))),a.getUserAchievement=a.getUserAchievement.bind(Object(l.a)(Object(l.a)(a))),a.getTop10Kill=a.getTop10Kill.bind(Object(l.a)(Object(l.a)(a))),a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"switchToSignUp",value:function(){this.setState(function(e,t){return{state:"signup"}})}},{key:"switchToLogin",value:function(){this.setState(function(e,t){return{state:"login"}})}},{key:"switchToMainGame",value:function(){this.setState(function(e,t){return{state:"maingame"}})}},{key:"switchToProfile",value:function(){this.getUserAchievement(),this.setState(function(e,t){return{state:"profile"}})}},{key:"switchToAchievement",value:function(){this.setState(function(e,t){return{state:"profile"}})}},{key:"getUserInfo",value:function(){var e=this,t=this.currentUser.info.userid;t?A.a.get("/api/user/"+t).then(function(t){e.currentUser.setInfo(t.data)}).catch(function(t){e.handleError("Unable to retrieve User Profile")}):this.handleError("Unable to retrieve USER ID, please login again")}},{key:"getUserAchievement",value:function(){var e=this,t=this.currentUser.info.userid;t?A.a.get("/api/achievement/"+t).then(function(t){e.currentUser.setAchievement(t.data),e.setState({})}).catch(function(t){e.handleError("Unable to retrieve User achievement")}):this.handleError("Unable to retrieve USER ID, please login again")}},{key:"getTop10Kill",value:function(){var e=this;A.a.get("/api/achievement").then(function(e){}).catch(function(t){e.handleError("Unable to retrieve Top 10 Player")})}},{key:"handleError",value:function(e){this.setState({error:!0,errorMessage:e})}},{key:"handleErrorClose",value:function(){this.setState({error:!1,errorMessage:""})}},{key:"handleInfo",value:function(e){this.setState({info:!0,infoMessage:e})}},{key:"handleInfoClose",value:function(){this.setState({info:!1,infoMessage:""})}},{key:"render",value:function(){var e=this.state.state,t=i.a.createElement(ce.a,{anchorOrigin:{vertical:"top",horizontal:"center"},open:this.state.error,autoHideDuration:6e3,onClose:this.handleErrorClose},i.a.createElement(Ce,{onClose:this.handleErrorClose,variant:"error",message:this.state.errorMessage})),a=i.a.createElement(ce.a,{anchorOrigin:{vertical:"top",horizontal:"center"},open:this.state.info,autoHideDuration:6e3,onClose:this.handleInfoClose},i.a.createElement(Ce,{onClose:this.handleInfoClose,variant:"success",message:this.state.infoMessage}));return"login"===e?i.a.createElement("main",null,t,a,i.a.createElement(R,{switchToMainGame:this.switchToMainGame,switchToSignUp:this.switchToSignUp,switchToLogin:this.switchToLogin,currentUser:this.currentUser,clientGameSocket:this.clientGameSocket,getUserInfo:this.getUserInfo,handleError:this.handleError,handleInfo:this.handleInfo})):"signup"===e?i.a.createElement("main",null,t,a,i.a.createElement(Q,{switchToMainGame:this.switchToMainGame,switchToSignUp:this.switchToSignUp,switchToLogin:this.switchToLogin,currentUser:this.currentUser,clientGameSocket:this.clientGameSocket,getUserInfo:this.getUserInfo,handleError:this.handleError,handleInfo:this.handleInfo})):"maingame"===e?i.a.createElement("main",null,t,a,i.a.createElement(ae,{switchToLogin:this.switchToLogin,switchToProfile:this.switchToProfile,currentUser:this.currentUser,clientGameSocket:this.clientGameSocket,getUserInfo:this.getUserInfo,game:this.game,handleError:this.handleError,handleInfo:this.handleInfo})):"profile"===e?i.a.createElement("main",null,t,a,i.a.createElement(se,{switchToMainGame:this.switchToMainGame,switchToLogin:this.switchToLogin,currentUser:this.currentUser,clientGameSocket:this.clientGameSocket,getUserInfo:this.getUserInfo,handleError:this.handleError,handleInfo:this.handleInfo})):void 0}}]),t}(n.Component);s.a.render(i.a.createElement(Gt,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[127,1,2]]]);
//# sourceMappingURL=main.15e31835.chunk.js.map